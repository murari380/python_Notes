
# 1. Import Required Libraries
import pandas as pd
import numpy as np

from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.metrics import mean_absolute_error, r2_score


# 2. Create Dataset
data = {
    'Area': [500, 800, 1000, 1200, 1500, 1800, 2000],
    'Price': [50, 80, 100, 130, 160, 200, 230]
}

df = pd.DataFrame(data)
print("Dataset:")
print(df)


# 3. Separate Features & Target
X = df[['Area']]   # Feature (must be 2D)
y = df['Price']    # Target


# 4. Train-Test Split
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)



# 5. Linear Regression
linear_model = LinearRegression()
linear_model.fit(X_train, y_train)

# Predictions
y_pred_linear = linear_model.predict(X_test)

# Evaluation
print("\n--- Linear Regression ---")
print("Slope (m):", linear_model.coef_)
print("Intercept (c):", linear_model.intercept_)
print("MAE:", mean_absolute_error(y_test, y_pred_linear))
print("R2 Score:", r2_score(y_test, y_pred_linear))


# 6. Polynomial Regression

poly = PolynomialFeatures(degree=2)

X_poly_train = poly.fit_transform(X_train)
X_poly_test = poly.transform(X_test)

poly_model = LinearRegression()
poly_model.fit(X_poly_train, y_train)

# Predictions
y_pred_poly = poly_model.predict(X_poly_test)

# Evaluation
print("\n--- Polynomial Regression (Degree 2) ---")
print("MAE:", mean_absolute_error(y_test, y_pred_poly))
print("R2 Score:", r2_score(y_test, y_pred_poly))



# 7. Predict New House Price

new_area = np.array([[1400]])

linear_price = linear_model.predict(new_area)
poly_price = poly_model.predict(poly.transform(new_area))

print("\n--- New Prediction for Area = 1400 ---")
print("Linear Regression Price:", linear_price[0])
print("Polynomial Regression Price:", poly_price[0])
